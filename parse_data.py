
raw_data = """15/12/2025	88.540,00	20.389,00		6
14/12/2025	71.553,00	88.719,00	10.000,00	8
13/12/2025	141.730,00			8
12/12/2025	120.921,00	19.772,00		6
11/12/2025	61.645,00	59.544,00		6
10/12/2025				0
9/12/2025				0
8/12/2025	70.128,00	67.990,00		6
7/12/2025	128.298,00	47.380,00		8
6/12/2025	176.512,00			8
5/12/2025	61.308,00	53.536,00		6
4/12/2025	99.089,00	22.306,00		6
3/12/2025				0
2/12/2025				0
1/12/2025	30.344,00	9.891,00		6
30/11/2025	48.322,00	42.372,00		8
29/11/2025	56.029,00	98.399,00		8
28/11/2025	9.532,00	47.665,00		6
27/11/2025	83.500,00	8.448,00		6
26/11/2025				0
25/11/2025	2.785,00	128.383,00		0
24/11/2025				6
23/11/2025	68.312,00	103.146,00		8
22/11/2025	65.887,00	100.469,00		8
21/11/2025	71.295,00	22.494,00		6
20/11/2025	20.780,00	42.136,00		6
19/11/2025				0
18/11/2025				0
17/11/2025	26.542,00	45.588,00		6
16/11/2025	8.714,00	190.993,00	5.000,00	8
15/11/2025	86.163,00	85.864,00		8
14/11/2025	21.999,00	46.777,00		6
13/11/2025	29.549,00	45.949,00		6
12/11/2025				0
11/11/2025				0
10/11/2025	19.963,00	29.282,00	56.000,00	6
9/11/2025	29.425,00	104.235,00	0,00	8
8/11/2025	61.102,00	56.709,00	0,00	8
7/11/2025	15.569,00	57.170,00	0,00	6
6/11/2025	23.892,00	57.087,00	0,00	6
5/11/2025	0,00	0,00	0,00	0
4/11/2025	0,00	0,00	0,00	0
3/11/2025	6.659,00	62.295,00	0,00	6
2/11/2025	72.851,00	141.148,00	0,00	8
1/11/2025	0,00	0,00	0,00	8
31/10/2025	60.292,00	23.129,00	0,00	6
30/10/2025	29.508,00	32.393,00	0,00	6
29/10/2025	28.066,00	28.116,00	0,00	0
28/10/2025	0,00	0,00	0,00	0
27/10/2025	27.064,00	39.866,00	0,00	6
26/10/2025	128.556,00	21.770,00	0,00	8
25/10/2025	136.997,00	32.558,00	0,00	8
24/10/2025	72.894,00	40.372,00	0,00	6
23/10/2025	22.513,00	31.709,00	0,00	6
22/10/2025	0,00	0,00	0,00	0
21/10/2025	0,00	0,00	0,00	0
20/10/2025	20.826,00	76.370,00	0,00	6
19/10/2025	18.367,00	75.191,00	0,00	8
18/10/2025	29.661,00	175.792,00	0,00	8
17/10/2025	6.630,00	15.089,00	0,00	6
16/10/2025	0,00	0,00	0,00	6
15/10/2025	0,00	0,00	0,00	0
14/10/2025	0,00	0,00	0,00	0
13/10/2025	46.724,00	17.000,00	43.000,00	6
12/10/2025	22.645,00	79.572,00	64.000,00	8
11/10/2025	84.990,00	15.669,00	92.000,00	8
10/10/2025	35.838,00	51.935,00		6
9/10/2025	15.225,00	28.765,00	20.000,00	6
8/10/2025	0,00	0,00	0,00	0
7/10/2025	0,00	0,00	0,00	0
6/10/2025	78.734,00	5.000,00	0,00	6
5/10/2025	133.585,00	20.504,00	10.000,00	8
4/10/2025	80.090,00	60.227,00	33.590,00	8
3/10/2025	0,00	0,00	0,00	6
2/10/2025	26.670,00	29.000,00	52.000,00	6
1/10/2025	0,00	0,00	0,00	0
30/9/2025	0,00	0,00	0,00	0
29/9/2025	28.333,00	25.479,00	30.000,00	6
28/9/2025	0,00	0,00	0,00	8
27/9/2025	49.053,00	56.605,00	0,00	8
26/9/2025	30.828,00	9.159,00	23.600,00	6
25/9/2025	40.185,00	37.700,00	16.000,00	6
24/9/2025	0,00	0,00	0,00	0
23/9/2025	0,00	0,00	0,00	0
22/9/2025	15.929,00	40.059,00	22.000,00	6
21/9/2025	60.252,00	56.606,00	53.000,00	8
20/9/2025	47.435,00	26.007,00	40.000,00	8
19/9/2025	20.378,00	26.502,00	47.000,00	6
18/9/2025	32.893,00	14.934,00	44.000,00	6
17/9/2025	0,00	0,00	0,00	0
16/9/2025	0,00	0,00	0,00	0
15/9/2025	72.966,00	0,00	0,00	6
14/9/2025	55.399,00	14.642,00	45.900,00	8
13/9/2025	75.209,00	85.233,00	0,00	8
12/9/2025	40.840,00	7.320,00	19.300,00	6
11/9/2025	25.492,00	27.030,00	0,00	6
10/9/2025	44.114,00	5.211,00	0,00	0
9/9/2025	0,00	0,00	0,00	0
8/9/2025	0,00	0,00	0,00	6
7/9/2025	77.505,00	41.113,00	65.000,00	8
6/9/2025	65.615,00	73.169,00	15.000,00	8
5/9/2025	52.473,00	25.283,00	30.000,00	6
4/9/2025	47.752,00	31.832,00	0,00	6
3/9/2025	0,00	0,00	0,00	0
2/9/2025	0,00	0,00	0,00	0
1/9/2025	145.912,00	16.847,00	0,00	6"""

import json

def parse_currency(val):
    if not val: return 0
    # format "88.540,00" -> 88540
    # "1.000" -> 1000
    clean = val.replace('.', '').replace(',', '.')
    try:
        return float(clean)
    except:
        return 0

def parse_hours(val):
    if not val: return 0
    clean = val.replace(',', '.')
    try:
        return float(clean)
    except:
        return 0

def parse_date(date_str):
    parts = date_str.split('/')
    if len(parts) == 3:
        return f"{parts[2]}-{parts[1].zfill(2)}-{parts[0].zfill(2)}"
    return ""

rows = raw_data.strip().split('\n')
json_data = []

for line in rows:
    parts = line.split('\t')
    if len(parts) < 1: continue
    
    date_str = parts[0]
    date = parse_date(date_str)
    
    if not date: continue

    uber = parse_currency(parts[1]) if len(parts) > 1 else 0
    didi = parse_currency(parts[2]) if len(parts) > 2 else 0
    otros = parse_currency(parts[3]) if len(parts) > 3 else 0
    hours = parse_hours(parts[4]) if len(parts) > 4 else 0

    platforms = [
        {'name': 'Uber', 'amount': uber},
        {'name': 'Didi', 'amount': didi},
        {'name': 'Otros', 'amount': otros}
    ]
    
    active_platforms = [p for p in platforms if p['amount'] > 0]
    
    # Logic: if earnings present, split
    if active_platforms:
        max_earner = max(active_platforms, key=lambda x: x['amount'])
        for p in active_platforms:
            shift_hours = hours if p['name'] == max_earner['name'] else 0
            json_data.append({
                'date': date,
                'platform': p['name'],
                'hours': shift_hours,
                'earnings': p['amount']
            })
    elif hours > 0:
        # Case: 0 earnings but hours > 0
        json_data.append({
            'date': date,
            'platform': 'Otros',
            'hours': hours,
            'earnings': 0
        })

print(json.dumps(json_data, indent=2))
